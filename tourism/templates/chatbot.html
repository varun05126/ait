{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI Travel Assistant ‚Äì AIT</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="{% static 'css/style.css' %}">

<style>
/* ===== GLOBAL ===== */
body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Inter,Roboto,sans-serif;
background:radial-gradient(circle at top,#e0f2fe,#f8fafc 40%);
color:#0f172a}

/* ===== NAVBAR ===== */
.navbar-wrap{
max-width:1250px;
margin:24px auto 0;
padding:18px 26px;
border-radius:26px;
background:linear-gradient(135deg,#38bdf8,#0ea5e9);
box-shadow:0 25px 60px rgba(0,0,0,.18)}

.navbar{
display:flex;
align-items:center;
justify-content:space-between}

.brand h1{
margin:0;
font-size:2.1rem;
font-weight:800}

.brand a{color:white;text-decoration:none}

.brand p{margin:4px 0 0;color:#e0f2fe;font-size:.95rem}

.nav-links{display:flex;gap:26px}

.nav-links a{
color:white;
text-decoration:none;
font-weight:600;
font-size:.95rem;
position:relative}

.nav-links a::after{
content:"";position:absolute;left:0;bottom:-4px;
width:0;height:2px;background:white;transition:.3s}

.nav-links a:hover::after{width:100%}

/* ===== SEPARATOR ===== */
.nav-separator{
max-width:1250px;
margin:26px auto 10px;
height:1px;
background:linear-gradient(to right,transparent,rgba(14,165,233,.45),transparent);
}

/* ===== CHATBOT UI ===== */
main{
max-width:1150px;
margin:50px auto;
padding:10px 10px 60px}

.chatbot-section{text-align:center}

.chatbot-section h2{font-size:2.5rem;font-weight:800}
.chatbot-section p{color:#475569;margin-bottom:2rem}

.chat-container{
display:grid;
grid-template-columns:1.1fr .9fr;
gap:26px}

.chat-box,.map-card{
background:rgba(255,255,255,.75);
backdrop-filter:blur(20px);
border-radius:26px;
box-shadow:0 30px 80px rgba(0,0,0,.12);
overflow:hidden}

.chat-window{padding:22px;height:420px;overflow-y:auto;text-align:left}

.chat-message{
margin-bottom:14px;
max-width:85%;
padding:12px 14px;
border-radius:14px;
font-size:.95rem}

.chat-user{
background:linear-gradient(135deg,#38bdf8,#0ea5e9);
color:white;margin-left:auto}

.chat-ai{background:#f1f5f9}

.chat-input{
display:flex;gap:10px;padding:16px;border-top:1px solid #e5e7eb}

.chat-input input{
flex:1;border-radius:999px;border:1px solid #e5e7eb;padding:12px}

.chat-input button{
border:none;border-radius:999px;padding:12px 22px;
background:linear-gradient(135deg,#38bdf8,#0ea5e9);
color:white;font-weight:700;cursor:pointer}

.map-card{padding:14px}
.map-card h3{margin:6px;font-size:1.2rem}
#map{height:420px;border-radius:20px}

@media(max-width:900px){
.chat-container{grid-template-columns:1fr}
#map{height:300px}
}
</style>
</head>

<body>

<!-- NAVBAR -->
<div class="navbar-wrap">
  <div class="navbar">
    <div class="brand">
      <h1><a href="/">AIT ‚Äì AI Tourism</a></h1>
      <p>Smart travel planning powered by artificial intelligence</p>
    </div>
    <div class="nav-links">
      <a href="/">Home</a>
      <a href="/destinations/">Destinations</a>
      <a href="/planner/">Plan a Trip</a>
      <a href="/chatbot/">Chatbot</a>
      <a href="/about/">About</a>
      <a href="/contact/">Contact</a>
    </div>
  </div>
</div>

<div class="nav-separator"></div>

<main>

<section class="chatbot-section">

<h2>üí¨ AI Travel Assistant</h2>
<p>Your intelligent travel companion for planning, exploring, and refining journeys.</p>

<div class="chat-container">

<div class="chat-box">
  <div class="chat-window" id="chat-window">
    <div class="chat-message chat-ai">
      üëã Hello! Ask me about destinations, budgets, or full trip plans.
    </div>
  </div>

  <form id="chat-form" class="chat-input">
    {% csrf_token %}
    <input type="text" id="user-input" placeholder="Ask about trips, places, budgets..." required>
    <button type="submit">Send ‚úàÔ∏è</button>
  </form>
</div>

<div class="map-card">
  <h3>üåç Explore on Map</h3>
  <div id="map"></div>
</div>

</div>
</section>

</main>

<script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places" async defer></script>

<script>
function initMap(){
const center={lat:20.5937,lng:78.9629};
const map=new google.maps.Map(document.getElementById("map"),{zoom:4,center:center});
new google.maps.Marker({position:center,map:map});
}

window.addEventListener("load",()=>{if(window.google)initMap()});

/* CHAT */
document.getElementById("chat-form").addEventListener("submit",async e=>{
e.preventDefault();
const input=document.getElementById("user-input");
const msg=input.value.trim();
if(!msg)return;
append(msg,"user");input.value="";
try{
const res=await fetch("{% url 'chatbot_response' %}",{
method:"POST",
headers:{"Content-Type":"application/json","X-CSRFToken":getCookie("csrftoken")},
body:JSON.stringify({message:msg})
});
const data=await res.json();
append(data.reply||"No response","ai");
}catch{append("Server error","ai")}
});

function append(text,type){
const chat=document.getElementById("chat-window");
const div=document.createElement("div");
div.className="chat-message "+(type==="user"?"chat-user":"chat-ai");
div.innerText=text;chat.appendChild(div);
chat.scrollTop=chat.scrollHeight;
}

function getCookie(name){
let v=null;
document.cookie.split(';').forEach(c=>{
c=c.trim();if(c.startsWith(name+'='))v=decodeURIComponent(c.substring(name.length+1))
});return v}
</script>

</body>
</html>